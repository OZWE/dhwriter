(function(e){"use strict";function n(t){var n=t.data;if(!t.isDefaultPrevented()){t.preventDefault();e(this).ajaxSubmit(n)}}function r(t){var n,r,i,s=t.target,o=e(s);if(!o.is("[type=submit],[type=image]")){n=o.closest("[type=submit]");if(n.length===0)return;s=n[0]}r=this;r.clk=s;if(s.type=="image")if(t.offsetX!==undefined){r.clk_x=t.offsetX;r.clk_y=t.offsetY}else if(typeof e.fn.offset=="function"){i=o.offset();r.clk_x=t.pageX-i.left;r.clk_y=t.pageY-i.top}else{r.clk_x=t.pageX-s.offsetLeft;r.clk_y=t.pageY-s.offsetTop}setTimeout(function(){r.clk=r.clk_x=r.clk_y=null},100)}function i(){var t;if(!e.fn.ajaxSubmit.debug)return;t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}var t={};t.fileapi=e("<input type='file'/>").get(0).files!==undefined;t.formdata=window.FormData!==undefined;e.fn.ajaxSubmit=function(n){function T(t){var n,r,i=e.param(t).split("&"),s=i.length,o={};for(n=0;n<s;n++){r=i[n].split("=");o[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return o}function N(t){var i,s,o,u,a,f=new FormData;for(i=0;i<t.length;i++)f.append(t[i].name,t[i].value);if(n.extraData){s=T(n.extraData);for(o in s)s.hasOwnProperty(o)&&f.append(o,s[o])}n.data=null;u=e.extend(!0,{},e.ajaxSettings,n,{contentType:!1,processData:!1,cache:!1,type:r||"POST"});n.uploadProgress&&(u.xhr=function(){var e=jQuery.ajaxSettings.xhr();e.upload&&(e.upload.onprogress=function(e){var t=0,r=e.loaded||e.position,i=e.total;e.lengthComputable&&(t=Math.ceil(r/i*100));n.uploadProgress(e,r,i,t)});return e});u.data=null;a=u.beforeSend;u.beforeSend=function(e,t){t.data=f;a&&a.call(this,e,t)};return e.ajax(u)}function C(t){function D(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function P(){function f(){var e;try{e=D(p).readyState;i("state = "+e);e&&e.toLowerCase()=="uninitialized"&&setTimeout(f,50)}catch(t){i("Server abort: ",t," (",t.name,")");H(w);y&&clearTimeout(y);y=undefined}}var t,n,s=u.attr("target"),o=u.attr("action");O.setAttribute("target",c);r||O.setAttribute("method","POST");o!=a.url&&O.setAttribute("action",a.url);!a.skipEncodingOverride&&(!r||/post/i.test(r))&&u.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});a.timeout&&(y=setTimeout(function(){g=!0;H(b)},a.timeout));t=[];try{if(a.extraData)for(n in a.extraData)a.extraData.hasOwnProperty(n)&&(e.isPlainObject(a.extraData[n])&&a.extraData[n].hasOwnProperty("name")&&a.extraData[n].hasOwnProperty("value")?t.push(e('<input type="hidden" name="'+a.extraData[n].name+'">').attr("value",a.extraData[n].value).appendTo(O)[0]):t.push(e('<input type="hidden" name="'+n+'">').attr("value",a.extraData[n]).appendTo(O)[0]));if(!a.iframeTarget){h.appendTo("body");p.attachEvent?p.attachEvent("onload",H):p.addEventListener("load",H,!1)}setTimeout(f,15);O.submit()}finally{O.setAttribute("action",o);s?O.setAttribute("target",s):u.removeAttr("target");e(t).remove()}}function H(t){var n,r,s,o,u,l,c,v,m;if(d.aborted||C)return;try{T=D(p)}catch(E){i("cannot access response document: ",E);t=w}if(t===b&&d){d.abort("timeout");_.reject(d,"timeout");return}if(t==w&&d){d.abort("server abort");_.reject(d,"error","server abort");return}if(!T||T.location.href==a.iframeSrc)if(!g)return;p.detachEvent?p.detachEvent("onload",H):p.removeEventListener("load",H,!1);n="success";try{if(g)throw"timeout";s=a.dataType=="xml"||T.XMLDocument||e.isXMLDoc(T);i("isXml="+s);if(!s&&window.opera&&(T.body===null||!T.body.innerHTML)&&--N){i("requeing onLoad callback, DOM not available");setTimeout(H,250);return}o=T.body?T.body:T.documentElement;d.responseText=o?o.innerHTML:null;d.responseXML=T.XMLDocument?T.XMLDocument:T;s&&(a.dataType="xml");d.getResponseHeader=function(e){var t={"content-type":a.dataType};return t[e]};if(o){d.status=Number(o.getAttribute("status"))||d.status;d.statusText=o.getAttribute("statusText")||d.statusText}u=(a.dataType||"").toLowerCase();l=/(json|script|text)/.test(u);if(l||a.textarea){c=T.getElementsByTagName("textarea")[0];if(c){d.responseText=c.value;d.status=Number(c.getAttribute("status"))||d.status;d.statusText=c.getAttribute("statusText")||d.statusText}else if(l){v=T.getElementsByTagName("pre")[0];m=T.getElementsByTagName("body")[0];v?d.responseText=v.textContent?v.textContent:v.innerText:m&&(d.responseText=m.textContent?m.textContent:m.innerText)}}else u=="xml"&&!d.responseXML&&d.responseText&&(d.responseXML=k(d.responseText));try{x=A(d,u,a)}catch(t){n="parsererror";d.error=r=t||n}}catch(t){i("error caught: ",t);n="error";d.error=r=t||n}if(d.aborted){i("upload aborted");n=null}d.status&&(n=d.status>=200&&d.status<300||d.status===304?"success":"error");if(n==="success"){a.success&&a.success.call(a.context,x,"success",d);_.resolve(d.responseText,"success",d);f&&e.event.trigger("ajaxSuccess",[d,a])}else if(n){r===undefined&&(r=d.statusText);a.error&&a.error.call(a.context,d,n,r);_.reject(d,"error",r);f&&e.event.trigger("ajaxError",[d,a,r])}f&&e.event.trigger("ajaxComplete",[d,a]);f&&!--e.active&&e.event.trigger("ajaxStop");a.complete&&a.complete.call(a.context,d,n);C=!0;a.timeout&&clearTimeout(y);setTimeout(function(){a.iframeTarget||h.remove();d.responseXML=null},100)}var s,o,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O=u[0],M=!!e.fn.prop,_=e.Deferred();if(e("[name=submit],[id=submit]",O).length){alert('Error: Form elements must not have name or id of "submit".');_.reject();return _}if(t)for(o=0;o<l.length;o++){s=e(l[o]);M?s.prop("disabled",!1):s.removeAttr("disabled")}a=e.extend(!0,{},e.ajaxSettings,n);a.context=a.context||a;c="jqFormIO"+(new Date).getTime();if(a.iframeTarget){h=e(a.iframeTarget);m=h.attr("name");m?c=m:h.attr("name",c)}else{h=e('<iframe name="'+c+'" src="'+a.iframeSrc+'" />');h.css({position:"absolute",top:"-1000px",left:"-1000px"})}p=h[0];d={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(t){var n=t==="timeout"?"timeout":"aborted";i("aborting upload... "+n);this.aborted=1;if(p.contentWindow.document.execCommand)try{p.contentWindow.document.execCommand("Stop")}catch(r){}h.attr("src",a.iframeSrc);d.error=n;a.error&&a.error.call(a.context,d,n,t);f&&e.event.trigger("ajaxError",[d,a,n]);a.complete&&a.complete.call(a.context,d,n)}};f=a.global;f&&0===e.active++&&e.event.trigger("ajaxStart");f&&e.event.trigger("ajaxSend",[d,a]);if(a.beforeSend&&a.beforeSend.call(a.context,d,a)===!1){a.global&&e.active--;_.reject();return _}if(d.aborted){_.reject();return _}v=O.clk;if(v){m=v.name;if(m&&!v.disabled){a.extraData=a.extraData||{};a.extraData[m]=v.value;if(v.type=="image"){a.extraData[m+".x"]=O.clk_x;a.extraData[m+".y"]=O.clk_y}}}b=1;w=2;E=e("meta[name=csrf-token]").attr("content");S=e("meta[name=csrf-param]").attr("content");if(S&&E){a.extraData=a.extraData||{};a.extraData[S]=E}a.forceSync?P():setTimeout(P,10);N=50;k=e.parseXML||function(e,t){if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null};L=e.parseJSON||function(e){return window.eval("("+e+")")};A=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror");r&&r.dataFilter&&(o=r.dataFilter(o,n));typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=L(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o));return o};return _}var r,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x;if(!this.length){i("ajaxSubmit: skipping submit process - no element selected");return this}u=this;typeof n=="function"&&(n={success:n});r=this.attr("method");s=this.attr("action");o=typeof s=="string"?e.trim(s):"";o=o||window.location.href||"";o&&(o=(o.match(/^([^#]+)/)||[])[1]);n=e.extend(!0,{url:o,success:e.ajaxSettings.success,type:r||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);a={};this.trigger("form-pre-serialize",[this,n,a]);if(a.veto){i("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1){i("ajaxSubmit: submit aborted via beforeSerialize callback");return this}f=n.traditional;f===undefined&&(f=e.ajaxSettings.traditional);l=[];h=this.formToArray(n.semantic,l);if(n.data){n.extraData=n.data;c=e.param(n.data,f)}if(n.beforeSubmit&&n.beforeSubmit(h,this,n)===!1){i("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[h,this,n,a]);if(a.veto){i("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}p=e.param(h,f);c&&(p=p?p+"&"+c:c);if(n.type.toUpperCase()=="GET"){n.url+=(n.url.indexOf("?")>=0?"&":"?")+p;n.data=null}else n.data=p;d=[];n.resetForm&&d.push(function(){u.resetForm()});n.clearForm&&d.push(function(){u.clearForm(n.includeHidden)});if(!n.dataType&&n.target){v=n.success||function(){};d.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(v,arguments)})}else n.success&&d.push(n.success);n.success=function(e,t,r){var i,s,o=n.context||this;for(i=0,s=d.length;i<s;i++)d[i].apply(o,[e,t,r||u,u])};m=e('input[type=file]:enabled[value!=""]',this);g=m.length>0;y="multipart/form-data";b=u.attr("enctype")==y||u.attr("encoding")==y;w=t.fileapi&&t.formdata;i("fileAPI :"+w);E=(g||b)&&!w;n.iframe!==!1&&(n.iframe||E)?n.closeKeepAlive?e.get(n.closeKeepAlive,function(){S=C(h)}):S=C(h):(g||b)&&w?S=N(h):S=e.ajax(n);u.removeData("jqxhr").data("jqxhr",S);for(x=0;x<l.length;x++)l[x]=null;this.trigger("form-submit-notify",[this,n]);return this};e.fn.ajaxForm=function(t){var s;t=t||{};t.delegation=t.delegation&&e.isFunction(e.fn.on);if(!t.delegation&&this.length===0){s={s:this.selector,c:this.context};if(!e.isReady&&s.s){i("DOM not ready, queuing ajaxForm");e(function(){e(s.s,s.c).ajaxForm(t)});return this}i("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}if(t.delegation){e(document).off("submit.form-plugin",this.selector,n).off("click.form-plugin",this.selector,r).on("submit.form-plugin",this.selector,t,n).on("click.form-plugin",this.selector,t,r);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",t,n).bind("click.form-plugin",t,r)};e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m=[];if(this.length===0)return m;i=this[0];s=n?i.getElementsByTagName("*"):i.elements;if(!s)return m;for(o=0,c=s.length;o<c;o++){l=s[o];a=l.name;if(!a)continue;if(n&&i.clk&&l.type=="image"){if(!l.disabled&&i.clk==l){m.push({name:a,value:e(l).val(),type:l.type});m.push({name:a+".x",value:i.clk_x},{name:a+".y",value:i.clk_y})}continue}f=e.fieldValue(l,!0);if(f&&f.constructor==Array){r&&r.push(l);for(u=0,h=f.length;u<h;u++)m.push({name:a,value:f[u]})}else if(t.fileapi&&l.type=="file"&&!l.disabled){r&&r.push(l);p=l.files;if(p.length)for(u=0;u<p.length;u++)m.push({name:a,value:p[u],type:l.type});else m.push({name:a,value:"",type:l.type})}else if(f!==null&&typeof f!="undefined"){r&&r.push(l);m.push({name:a,value:f,type:l.type,required:l.required})}}if(!n&&i.clk){d=e(i.clk),v=d[0];a=v.name;if(a&&!v.disabled&&v.type=="image"){m.push({name:a,value:d.val()});m.push({name:a+".x",value:i.clk_x},{name:a+".y",value:i.clk_y})}}return m};e.fn.formSerialize=function(t){return e.param(this.formToArray(t))};e.fn.fieldSerialize=function(t){var n=[];this.each(function(){var r,i,s,o=this.name;if(!o)return;r=e.fieldValue(this,t);if(r&&r.constructor==Array)for(i=0,s=r.length;i<s;i++)n.push({name:o,value:r[i]});else r!==null&&typeof r!="undefined"&&n.push({name:this.name,value:r})});return e.param(n)};e.fn.fieldValue=function(t){var n,r,i,s,o;for(n=[],r=0,i=this.length;r<i;r++){s=this[r];o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n};e.fieldValue=function(t,n){var r,i,s,o,u,a,f,l,c=t.name,h=t.type,p=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!c||t.disabled||h=="reset"||h=="button"||(h=="checkbox"||h=="radio")&&!t.checked||(h=="submit"||h=="image")&&t.form&&t.form.clk!=t||p=="select"&&t.selectedIndex==-1))return null;if(p=="select"){r=t.selectedIndex;if(r<0)return null;i=[],s=t.options;o=h=="select-one";u=o?r+1:s.length;for(a=o?r:0;a<u;a++){f=s[a];if(f.selected){l=f.value;l||(l=f.attributes&&f.attributes.value&&!f.attributes.value.specified?f.text:f.value);if(o)return l;i.push(l)}}return i}return e(t).val()};e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})};e.fn.clearFields=e.fn.clearInputs=function(t){var n=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var r=this.type,i=this.tagName.toLowerCase();n.test(r)||i=="textarea"?this.value="":r=="checkbox"||r=="radio"?this.checked=!1:i=="select"?this.selectedIndex=-1:t&&(t===!0&&/hidden/.test(r)||typeof t=="string"&&e(this).is(t))&&(this.value="")})};e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})};e.fn.enable=function(e){e===undefined&&(e=!0);return this.each(function(){this.disabled=!e})};e.fn.selected=function(t){t===undefined&&(t=!0);return this.each(function(){var n,r=this.type;if(r=="checkbox"||r=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){n=e(this).parent("select");t&&n[0]&&n[0].type=="select-one"&&n.find("option").selected(!1);this.selected=t}})};e.fn.ajaxSubmit.debug=!1})(jQuery);