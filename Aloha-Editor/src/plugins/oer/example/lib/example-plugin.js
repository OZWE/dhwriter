(function(){define(["aloha","aloha/plugin","jquery","aloha/ephemera","ui/ui","ui/button","semanticblock/semanticblock-plugin","css!example/css/example-plugin.css"],function(e,t,n,r,i,s,o){var u=n('<span class="type-container dropdown aloha-ephemera">\n    <span class="type btn-link" href="#" data-toggle="dropdown"></span>\n    <ul class="dropdown-menu">\n    </ul>\n</span>'),a={},f=[];return t.create("example",{defaults:[{label:"Activity",cls:"example",hasTitle:!0,type:"activity"},{label:"Practical",cls:"example",hasTitle:!0,type:"practical"},{label:"Demonstration",cls:"example",hasTitle:!0,type:"demonstration"},{label:"Example",cls:"example",hasTitle:!0},{label:"Case in point",cls:"example",hasTitle:!0,type:"case-in-point"},{label:"Case study",cls:"example",hasTitle:!0,type:"case-study"},{label:"Illustration",cls:"example",hasTitle:!0,type:"illustration"}],getLabel:function(e){var t,n,r;for(n=0,r=f.length;n<r;n++){t=f[n];if(e.is(t.selector))return t.label}},activate:function(e){var t,r,i=this,s=e.children(".title");s.attr("hover-placeholder","Add a title (optional)");s.aloha();r="Exercise";t=e.contents().not(s);n.each(f,function(t,i){var s;if(e.is(i.selector)){r=i.label;s=u.clone();if(f.length>1)n.each(f,function(t,r){var i=n('<li><a href="#"></a></li>');i.appendTo(s.find(".dropdown-menu"));i=i.children("a");i.text(r.label);s.find(".type").on("click",function(){return n.each(f,function(t,r){if(e.attr("data-type")===r.type)return s.find(".dropdown-menu li").each(function(e,t){n(t).removeClass("checked");if(n(t).children("a").text()===r.label)return n(t).addClass("checked")})})});return i.on("click",function(t){var i,o;t.preventDefault();if(r.hasTitle){if(!e.children(".title")[0]){i=n("<"+(r.titleTagName||"span")+" class='title'></"+(r.titleTagName||"span"));e.append(i);i.aloha()}}else e.children(".title").remove();r.type?e.attr("data-type",r.type):e.removeAttr("data-type");s.find(".type").text(r.label);for(o in a)e.removeClass(o);return e.addClass(r.cls)})});else{s.find(".dropdown-menu").remove();s.find(".type").removeAttr("data-toggle")}s.find(".type").text(i.label);return s.prependTo(e)}});return n("<div>").addClass("body").addClass("aloha-block-dropzone").attr("placeholder","Type the text of your "+r.toLowerCase()+" here.").appendTo(e).aloha().append(t)},deactivate:function(e){var t,r,i,s,o=this,u=e.children(".body"),a=u.children().length!==u.contents().length,l=u.text().trim()==="";if(l)u=n('<p class="para"></p>');else{u=u.contents();a&&(u=u.wrap("<p></p>").parent())}e.children(".body").remove();i=void 0;s="span";n.each(f,function(t,n){if(e.is(n.selector)){i=n.hasTitle||!1;return s=n.titleTagName||s}});if(i||i===void 0){r=e.children(".title");t=n("<"+s+' class="title"></'+s+">");if(r.length){t.append(r.contents());r.remove()}t.prependTo(e)}return e.append(u)},selector:".example",init:function(){var e=this;f=this.settings;n.each(f,function(e,t){var r,u=t.cls||function(){throw"BUG Invalid configuration of example plugin. cls required!"}(),f=t.type,l=!!t.hasTitle,c=t.label||function(){throw"BUG Invalid configuration of example plugin. label required!"}(),h=t.tagName||"div",p=t.titleTagName||"div";f?t.selector="."+u+"[data-type='"+f+"']":t.selector="."+u+":not([data-type])";a[u]=!0;r=n("<"+h+"></"+h);r.addClass(u);f&&r.attr("data-type",f);l&&r.append("<"+p+" class='title'></"+p);i.adopt("insert-"+u+f,s,{click:function(){return o.insertAtCursor(r.clone())}});if("example"===u&&!f)return i.adopt("insertExample",s,{click:function(){return o.insertAtCursor(r.clone())}})});return o.register(this)}})})}).call(this);